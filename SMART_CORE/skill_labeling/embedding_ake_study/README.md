# Embedding-based Automatic Keyphrase Extraction Experiment

## Description
Code in the `embedding_ake_study` sub-directory runs an experiment to determine the appropriate choice for candidate keyphrase generation, document embeddings, and ranking/selection for embedding-based keyphrase extraction.  

The options for candidate keyphrase generation are:
- n-grams: use the unigrams, bigrams, and trigrams from the processed document as candidate keyphrases.
- parsing: parse out noun phrases composed of adjectives and nouns as candidate keyphrases.  

The options for document embeddings are:
- Word2vec
- GloVE
- Doc2vec
- Sentence-BERT

The options for ranking and selection are:
- top-n: Take the top n candidates by cosine similarity between the candidate embedding and document embedding.
- top-n-modified: Take the top n candidates by score, where score is the sum of the cosine similarity between terms in the candidate and the document.
- mmr: Take the top n candidates by score after applying Maximal Marginal Relevance (MMR) 
- mss:  Take the top n candidates by score after applying Maximum Sum Similarity (MSS)

The experiment uses grid search of the settings for four datasets: OLI Introduction to Biology, OLI General Chemistry 1, Inspec, KDD
    
## Table of Contents
  * [Inputs](#inputs)
  * [Outputs](#outputs)
  * [Running the Experiment](#running-the-experiment)

## Inputs
The inputs required for the comparison study include:

- The output files generated by the [parser](../OLI%20XML%20Parser/README.md) for each course:
  - Assessments (assessments.csv)  
  - Paragraphs (paragraphs.csv)  
- The files with expert mapping of skills to assessment items from DataShop. For the OLI Introduction to Biology and OLI General Chemistry 1 courses, the files are on OneDrive at the `PASTEL Project/SMART/DataShop Export/OLI Biology/Skills` and `PASTEL Project/SMART/DataShop Export/OLI General Chemistry I/Skills` filepaths.
  - For OLI Introduction to Biology:
    - intro_bio_skill_map.tsv
    - intro_bio_skills.tsv
  - For OLI General Chemistry 1:
    - chem1_skill_map_2.3_5_20_20-Problems.tsv
    - chem1_skill_map_2.3_5_20_20-Skills.tsv

## Outputs
The study generates three output directories:

- `dataset_eda_updated`  
Graphs to show the document length, target keyphrase length, and number of target keyphrases per document for each dataset.

- `output` with three sub-directories:
  -   `ake_results`
    Files for each trial for each combination of settings for each dataset that contain the original document, target keyphrase(s), and extracted keyphrase(s).  
    
  -   `evaluation`
    A file for each dataset containing the evaluation results (precision, recall, f1) for the grid search.
    
  -   `temp`
    Used to store files showing the progress of running the experiment.

- `study_analysis`
  Charts showing the evaluation results (f1 score) for each combination of settings for each dataset.  
  
## Running the Experiment
To run the exploratory data analysis for the datasets, use the following command on the terminal:
```
python dataset_eda.py
```

To run the experiment, use the following command on the terminal:
```
bash run_ake_study_all_datasets.sh
```

To run additional analysis of the results, use the following command on the terminal:
```
Rscript ake_study_analysis_update.R
```
